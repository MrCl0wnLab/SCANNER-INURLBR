<?php

function __subExecExploits($target, $exploitArray = []): void {
    if($target):
        $cor = $GLOBALS['COR'];
        echo PHP_EOL, "{$cor->whit}|_[ INF ]__", PHP_EOL;
        echo "           |[ SUB PROCESS ]::", PHP_EOL;
        $target = __filterHostname($target);
        __plus();

        foreach ($exploitArray as $value):

            $postDados = !is_null($_SESSION["config"]["sub-post"]) ? __convertUrlQuery($value) : null;
            $patch_GP = is_null($postDados) ? $value : null;
            $url = $target . $_SESSION["config"]["sub-concat"] . $patch_GP;

            echo "{$cor->grey}-[||]{$cor->end}";
            $resultado__ = __request_info($url, $_SESSION["config"]["proxy"], $postDados);
            __plus();

            $ifcode = __not_empty($_SESSION['config']['ifcode']) &&
                    strstr($resultado__['server']['http_code'], $_SESSION['config']['ifcode']) ?
                    "CODE_HTTP_FOUND: {$_SESSION['config']['ifcode']} / " : null;
            $ifredirect = (strstr($resultado__['server']['redirect_url'], $_SESSION['config']['ifredirect'])) ? $resultado__['server']['redirect_url'] : null;
            $result_validation['erroReturn'] = $ifredirect . $ifcode . __checkError($resultado__['corpo']);
            __plus();

            $result_validation['vull_style'] = (__not_empty($result_validation['erroReturn'])) ?
                    "{$cor->blu1}[ INF ][ {$result_validation['erroReturn']} ]\n[ INF ][ TARGET POTENTIALLY VULNERABLE ]: " . __cli_beep() : null;
            echo __not_empty($result_validation['erroReturn']) ? PHP_EOL."{$result_validation['vull_style']}{$url}\n{$cor->end}" : null;
            echo __not_empty($result_validation['erroReturn']) ? __saveValue($_SESSION['config']['arquivo_output'], $url, 1) . PHP_EOL : null;
            __plus();

            $_SESSION['config']['result_values'].=(__not_empty($result_validation['erroReturn']) ? $url.PHP_EOL : null);
            (__not_empty($result_validation['erroReturn']) && __not_empty($_SESSION['config']['irc']['irc_connection']) ?
                            __ircMsg($_SESSION['config']['irc'], "{$result_validation['erroReturn']}::: {$url}") : null);

            (__not_empty($result_validation['erroReturn']) && !is_null($_SESSION['config']['sub-cmd-vul']) ? __command($_SESSION['config']['sub-cmd-vul'], $url) : null);
            (__not_empty($_SESSION['config']['sub-cmd-all']) ? __command($_SESSION['config']['sub-cmd-all'], $url) : null);
            __plus();
            __timeSec('delay');
        endforeach;
        unset($_ex);
    endif;
}