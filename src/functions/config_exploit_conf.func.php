<?php

################################################################################
#SETUP TO RUN COMMANDS IN ID####################################################
################################################################################
function __configExploitsExec($id, $target) {
    $cor = $GLOBALS['COR'];
    $result_config = __configExploitsList();
    $end = [];
    $id_xpls = strstr($id, ',') ? explode(',', $id) : [$id]; // MULTIPLAS ID'S EXPLOITS
    foreach ($result_config as $key):
        $key_filter = strstr($key, '::') ? explode("\n", $key) : null;
        $end = is_array($key_filter) ? array_merge($end, $key_filter) : $end;
    endforeach;
    foreach ($id_xpls as $value):
        $end_xpl = !is_null($value) ? explode('::', $end[$value]) : null;
        $bar = "{$cor->whit}[ XPL ]__{$cor->end}".PHP_EOL;
        $bar.= "         |{$cor->whit}";
        echo !is_null($end_xpl) ? PHP_EOL."{$bar}[ EXPLOIT ]:: {$end_xpl[0]} /[ ID ]:: {$value} /[ COMMAND ]:: " . $end_xpl[1] : null;
        echo !is_null($end_xpl) ? __command($end_xpl[1], $target) : null;
        __plus();
    endforeach;
}

################################################################################
#LIST COMMANDS FILE exploits.conf###############################################
################################################################################
function __configExploitsList($op = null) {
    $cor = $GLOBALS['COR'];
    $result_config = array_unique(array_filter(explode("\n", file_get_contents($_SESSION['config']['file_exploit_conf']))));
    if (!is_null($op)):
        echo "{$cor->mag1}[*]__", PHP_EOL;
        echo "     |MENU EXPLOITS:";
        echo PHP_EOL, "     |ID TYPE_EXPLOIT::EXPLOIT_COMMAND";
        echo PHP_EOL, "     |FILE CONFIG: {$_SESSION['config']['file_exploit_conf']}";
        echo PHP_EOL, "     |USE COMMAND EX: --exploit-id '1,2,3,19'";
        echo PHP_EOL, " ---------------------------------------------------------------------------------------------------------------------", PHP_EOL;
        __getOut($result_config);
        __getOut("{$_SESSION['config']['line']}".PHP_EOL);
        __plus();
    else:
        return is_array($result_config) ? $result_config : null;
    endif;
}